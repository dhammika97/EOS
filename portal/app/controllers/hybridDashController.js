// JavaScript Document
var myData = [
		{
			"Customer": "Magna",
			"Supplier": "Co-Ex-Tec to H&L",
			"Plant": "Newmarket",
			"Pick-Up": "Yes",
			"Pick-Up Date": "02 April 2016",
			"Arrival Date": "15 April 2016",
			"Stack": "Yes",
			"Comments": "02/10/16 10:00 SHEIKHA: Found Issues with gty",
			"Supplier Status": "ACCEPTED",
			"Assigned To": "",
			"Date": "",
			"By": "",
			"Status(Select)": "",
		},
		{
			"Customer": "aMagna",
			"Supplier": "Co-Ex-Tec to H&L",
			"Plant": "Newmarket",
			"Pick-Up": "Yes",
			"Pick-Up Date": "02 April 2016",
			"Arrival Date": "22 April 2016",
			"Stack": "Yes",
			"Comments": "02/10/16 10:00 SHEIKHA: Found Issues with gty",
			"Supplier Status": "ACCEPTED",
			"Assigned To": "",
			"Date": "",
			"By": "",
			"Status(Select)": "",
		},
		{
			"Customer": "aMagna",
			"Supplier": "Co-Ex-Tec to H&L",
			"Plant": "Newmarket",
			"Pick-Up": "Yes",
			"Pick-Up Date": "02 April 2016",
			"Arrival Date": "22 April 2016",
			"Stack": "Yes",
			"Comments": "02/10/16 10:00 SHEIKHA: Found Issues with gty",
			"Supplier Status": "ACCEPTED",
			"Assigned To": "",
			"Date": "",
			"By": "",
			"Status(Select)": "",
		},
		{
			"Customer": "aMagna",
			"Supplier": "Co-Ex-Tec to H&L",
			"Plant": "Newmarket",
			"Pick-Up": "Yes",
			"Pick-Up Date": "02 April 2016",
			"Arrival Date": "22 April 2016",
			"Stack": "Yes",
			"Comments": "02/10/16 10:00 SHEIKHA: Found Issues with gty",
			"Supplier Status": "ACCEPTED",
			"Assigned To": "",
			"Date": "",
			"By": "",
			"Status(Select)": "",
		},
		{
			"Customer": "aMagna",
			"Supplier": "Co-Ex-Tec to H&L",
			"Plant": "Newmarket",
			"Pick-Up": "Yes",
			"Pick-Up Date": "02 April 2016",
			"Arrival Date": "22 April 2016",
			"Stack": "Yes",
			"Comments": "02/10/16 10:00 SHEIKHA: Found Issues with gty",
			"Supplier Status": "ACCEPTED",
			"Assigned To": "",
			"Date": "",
			"By": "",
			"Status(Select)": "",
		},
		{
			"Customer": "aMagna",
			"Supplier": "Co-Ex-Tec to H&L",
			"Plant": "Newmarket",
			"Pick-Up": "Yes",
			"Pick-Up Date": "02 April 2016",
			"Arrival Date": "22 April 2016",
			"Stack": "Yes",
			"Comments": "02/10/16 10:00 SHEIKHA: Found Issues with gty",
			"Supplier Status": "ACCEPTED",
			"Assigned To": "",
			"Date": "",
			"By": "",
			"Status(Select)": "",
		},
		{
			"Customer": "aMagna",
			"Supplier": "Co-Ex-Tec to H&L",
			"Plant": "Newmarket",
			"Pick-Up": "Yes",
			"Pick-Up Date": "02 April 2016",
			"Arrival Date": "22 April 2016",
			"Stack": "Yes",
			"Comments": "02/10/16 10:00 SHEIKHA: Found Issues with gty",
			"Supplier Status": "ACCEPTED",
			"Assigned To": "",
			"Date": "",
			"By": "",
			"Status(Select)": "",
		},
		{
			"Customer": "aMagna",
			"Supplier": "Co-Ex-Tec to H&L",
			"Plant": "Newmarket",
			"Pick-Up": "Yes",
			"Pick-Up Date": "02 April 2016",
			"Arrival Date": "22 April 2016",
			"Stack": "Yes",
			"Comments": "02/10/16 10:00 SHEIKHA: Found Issues with gty",
			"Supplier Status": "ACCEPTED",
			"Assigned To": "",
			"Date": "",
			"By": "",
			"Status(Select)": "",
		},
		{
			"Customer": "aMagna",
			"Supplier": "Co-Ex-Tec to H&L",
			"Plant": "Newmarket",
			"Pick-Up": "Yes",
			"Pick-Up Date": "02 April 2016",
			"Arrival Date": "22 April 2016",
			"Stack": "Yes",
			"Comments": "02/10/16 10:00 SHEIKHA: Found Issues with gty",
			"Supplier Status": "ACCEPTED",
			"Assigned To": "",
			"Date": "",
			"By": "",
			"Status(Select)": "",
		},
		{
			"Customer": "aMagna",
			"Supplier": "Co-Ex-Tec to H&L",
			"Plant": "Newmarket",
			"Pick-Up": "Yes",
			"Pick-Up Date": "02 April 2016",
			"Arrival Date": "22 April 2016",
			"Stack": "Yes",
			"Comments": "02/10/16 10:00 SHEIKHA: Found Issues with gty",
			"Supplier Status": "ACCEPTED",
			"Assigned To": "",
			"Date": "",
			"By": "",
			"Status(Select)": "",
		},
		{
			"Customer": "aMagna",
			"Supplier": "Co-Ex-Tec to H&L",
			"Plant": "Newmarket",
			"Pick-Up": "Yes",
			"Pick-Up Date": "02 April 2016",
			"Arrival Date": "22 April 2016",
			"Stack": "Yes",
			"Comments": "02/10/16 10:00 SHEIKHA: Found Issues with gty",
			"Supplier Status": "ACCEPTED",
			"Assigned To": "",
			"Date": "",
			"By": "",
			"Status(Select)": "",
		},
		{
			"Customer": "aMagna",
			"Supplier": "Co-Ex-Tec to H&L",
			"Plant": "Newmarket",
			"Pick-Up": "Yes",
			"Pick-Up Date": "02 April 2016",
			"Arrival Date": "22 April 2016",
			"Stack": "Yes",
			"Comments": "02/10/16 10:00 SHEIKHA: Found Issues with gty",
			"Supplier Status": "ACCEPTED",
			"Assigned To": "",
			"Date": "",
			"By": "",
			"Status(Select)": "",
		},
		{
			"Customer": "aMagna",
			"Supplier": "Co-Ex-Tec to H&L",
			"Plant": "Newmarket",
			"Pick-Up": "Yes",
			"Pick-Up Date": "02 April 2016",
			"Arrival Date": "22 April 2016",
			"Stack": "Yes",
			"Comments": "02/10/16 10:00 SHEIKHA: Found Issues with gty",
			"Supplier Status": "ACCEPTED",
			"Assigned To": "",
			"Date": "",
			"By": "",
			"Status(Select)": "",
		},
		{
			"Customer": "aMagna",
			"Supplier": "Co-Ex-Tec to H&L",
			"Plant": "Newmarket",
			"Pick-Up": "Yes",
			"Pick-Up Date": "02 April 2016",
			"Arrival Date": "22 April 2016",
			"Stack": "Yes",
			"Comments": "02/10/16 10:00 SHEIKHA: Found Issues with gty",
			"Supplier Status": "ACCEPTED",
			"Assigned To": "",
			"Date": "",
			"By": "",
			"Status(Select)": "",
		}
	];
controllers.hybridDashController = function($scope){
	
	
	$scope.gridOptions = {
		columnDefs: [
		  { name: 'Customer', headerCellClass: 'HeaderStyle1', width: "10%" },
		  { name: 'Supplier', headerCellClass: 'HeaderStyle1' , width: "10%"},
		  { name: 'Plant', headerCellClass: 'HeaderStyle1'},
		  { name: 'Pick-Up', headerCellClass: 'HeaderStyle1'},
		  { name: 'Pick-Up Date', headerCellClass: 'HeaderStyle1'},
		  { name: 'Arrival Date', headerCellClass: 'HeaderStyle1'},
		  { name: 'Stack', headerCellClass: 'HeaderStyle1'},
		  { name: 'Comments', headerCellClass: 'HeaderStyle1', width: "250" },
		  { name: 'Supplier Status', headerCellClass: 'HeaderStyle2' , cellClass:'CellClassStyle1 bold'},
		  { name: 'assignedTo', displayName: 'Assigned To', headerCellClass: 'HeaderStyle2' , cellClass:'CellClassStyle1', 
		  editableCellTemplate: 'ui-grid/dropdownEditor',
		  editDropdownOptionsArray: [
      		{ id: 1, assignedTo: 'ABC' },
      		{ id: 2, assignedTo: 'DEF' }
    	  ], 
		  editDropdownIdLabel:'assignedTo',
		  editDropdownValueLabel: 'assignedTo'
		  },
		  { name: 'Date', headerCellClass: 'HeaderStyle2' , cellClass:'CellClassStyle1' },
		  { name: 'By', headerCellClass: 'HeaderStyle2' , cellClass:'CellClassStyle1'},
		  { name: 'Status(Select)', headerCellClass: 'HeaderStyle2' , cellClass:'CellClassStyle1'},
		  ]
		  
		};
	$scope.gridOptions.data = myData;
	
}

controllers.customerController = function($scope, customerFactory, customerAddFactory){
	objCombos = [{company_type:1,name: "test" },{company_type:2,name: "test2" },{company_type:3,name: "test3" }]
	$scope.partnerGridOptions = {
		columnDefs: [
		  { name: 'company_type', displayName: 'Partner Type', headerCellClass: 'HeaderStyle1',	
		  	filter: {}, 
			cellFilter: 'mapCompanyType',
			editableCellTemplate: 'ui-grid/dropdownEditor',
			editDropdownValueLabel: 'company_type_name', 
			editDropdownIdLabel: 'company_type',
			editDropdownOptionsArray: [
			  { company_type: 1, company_type_name: 'Admin' },
			  { company_type: 2, company_type_name: 'Customer' },
			  { company_type: 3, company_type_name: 'Supplier' },
			  { company_type: 4, company_type_name: 'Logistic' }
			]
		  },
		  { name: 'company_name', displayName: 'Company Name', headerCellClass: 'HeaderStyle1'},
		  { name: 'company_contact_name', displayName: 'Contact Full Name', headerCellClass: 'HeaderStyle1' },
		  { name: 'company_contact_no', displayName: 'Contact Phone No.', headerCellClass: 'HeaderStyle1'},
		  { name: 'company_email', displayName: 'Email Address', headerCellClass: 'HeaderStyle1' },
		  { name: 'company_alternate_contact', displayName: 'Alternate Contact', headerCellClass: 'HeaderStyle1'},
		  { name: 'Delete', displayName: '', headerCellClass: 'HeaderStyle1', width: 50, cellTemplate:"<div class='text-center'><i class='fa fa-trash'></i><div>", enableCellEdit: false}
		  ]
		};
	 
	customerFactory.query().$promise.then(function(data){
		$scope.partnerGridOptions.data = data.companies
	})
	
	$scope.partnerGridOptions.onRegisterApi = function(gridApi){
		$scope.gridApi = gridApi;
		gridApi.edit.on.afterCellEdit($scope, function(rowEntity, colDef, newValue, oldValue) {
			if(newValue != oldValue){
				customerAddFactory.updatePartner(rowEntity.company_id,rowEntity)
			}
		});
	}
}

controllers.addCustomerController = function($scope, customerAddFactory){
	$scope.keyPress = function(e){
		if (e.which === 13)
    	$scope.addPartner()
	}
	
	$scope.addPartner = function(isValid){
		$scope.submitted = true
		if(isValid){
			customerAddFactory.createPartner($scope.partner)
		}
	}
}
//App.controller(controllers)